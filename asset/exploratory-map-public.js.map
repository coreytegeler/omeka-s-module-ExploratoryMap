{"version":3,"sources":["webpack://ExploratoryMap/webpack/universalModuleDefinition","webpack://ExploratoryMap/webpack/bootstrap","webpack://ExploratoryMap/./asset/src/exploratory-map-public.js","webpack://ExploratoryMap/./asset/src/exploratory-map-public.scss"],"names":["require","ExploratoryMap","constructor","userOpts","self","defaultOpts","selector","color","options","Object","assign","markers","bounds","sources","layers","overlays","block","document","querySelector","console","warn","container","basemap","accessToken","dataset","removeAttribute","forms","querySelectorAll","mapboxgl","map","Map","zoom","on","handleMapLoad","bind","handleStyleLoad","setStyle","e","hoverMarker","unhoverMarker","clickMarker","forEach","arrow","i","addEventListener","clickArrow","item","clickItem","form","changeLayer","keys","length","addOverlays","addMarkers","layerID","getSource","layer","source","input","getElementById","checked","layout","visibility","addSource","addLayer","target","parentElement","id","sourceID","layerType","value","thisID","setLayoutProperty","checkedInputs","checkedValues","Array","from","setFilter","concat","checkboxes","checkbox","index","overlaySource","overlayLayer","markersStr","markersJSON","JSON","parse","mapBounds","LngLatBounds","markerObj","location","lat","lng","coords","marker","caption","title","Number","isInteger","type","data","features","push","getMarkerData","extend","markersLayer","hoverMarkersLayer","fitBounds","padding","top","bottom","left","right","animate","classList","add","resetMap","closePanel","flyTo","markerIndex","currentItem","currentIndex","remove","parseInt","nextItem","findItem","nextPanel","findPanel","panelPadding","panelWidth","offsetWidth","blockWidth","offsetX","coordStr","markerCoords","coordArr","center","speed","once","centerCoords","getCenter","position","project","x","unproject","openPanel","direction","getAttribute","items","nextElementSibling","previousElementSibling","nextMarkerId","api","$","ajax","dataType","url","success","populatePopup","populatePanel","error","jqXHR","status","log","popup","createElement","properties","popupTitle","innerText","appendChild","panel","panelHeader","panelTitle","prevArrow","nextArrow","panelInner","cloneNode","panelScroll","panelProperties","terms","term","slug","label","vals","panelProperty","panelPropertyLabel","valObj","j","replace","link","href","src","img","getCanvas","style","cursor","openPopup","closePopup","findPopup","setTimeout","findMarker","mapId","window","onload"],"mappings":"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","file":"exploratory-map-public.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"ExploratoryMap\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ExploratoryMap\"] = factory();\n\telse\n\t\troot[\"ExploratoryMap\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","require(\"./exploratory-map-public.scss\");\n\nclass ExploratoryMap {\n\tconstructor(userOpts = {}) {\n\t\tconst self = this;\n\t\tlet defaultOpts = {\n\t\t\tselector: \".exploratory-map-block\",\n\t\t\tcolor: \"#0dae0b\"\n\t\t}\n\t\tthis.options = Object.assign(defaultOpts, userOpts);\n\n\t\tthis.markers = [];\n\t\tthis.bounds = [];\n\t\tthis.sources = {};\n\t\tthis.layers = {};\n\t\tthis.overlays = {};\n\t\tthis.block = document.querySelector(this.options.selector);\n\t\tif(!this.block) {\n\t\t\tconsole.warn(\"No element matched the selector \\\"\"+this.options.selector+\"\\\"\");\n\t\t}\n\t\tthis.container = this.block.querySelector(\".map-container\");\n\t\tlet { basemap, accessToken } = this.block.dataset;\n\n\t\tthis.block.removeAttribute(\"data-basemap\");\n\t\tthis.block.removeAttribute(\"data-access-token\");\n\n\t\tthis.forms = this.block.querySelectorAll(\".layer-form\");\n\n\t\tmapboxgl.accessToken = accessToken;\n\t\tthis.map = new mapboxgl.Map({\n\t\t  container: this.container,\n\t\t  zoom: 3\n\t\t});\n\t\tthis.map.on(\"load\", self.handleMapLoad.bind(self));\n\t\tthis.map.on(\"style.load\", self.handleStyleLoad.bind(self));\n\t\tthis.map.setStyle(basemap);\n\t}\n\n\thandleMapLoad(e) {\n\t\tconst self = this;\n\t\tthis.map.on('mouseenter', \"markers\", this.hoverMarker.bind(this));\n\t\tthis.map.on('mouseleave', \"markers\", this.unhoverMarker.bind(this));\n\t\tthis.map.on(\"click\", \"markers\", this.clickMarker.bind(this));\n\n\t\tthis.block.querySelectorAll(\".map-arrow\").forEach(function(arrow, i) {\n\t\t\tarrow.addEventListener(\"mousedown\", self.clickArrow.bind(self));\n\t\t});\n\n\t\tthis.block.querySelectorAll(\".item\").forEach(function(item, i) {\n\t\t\titem.addEventListener(\"mousedown\", self.clickItem.bind(self));\n\t\t});\n\n\t\tthis.block.querySelectorAll(\".layer-form input\").forEach(function(form, i) {\n\t\t\tform.addEventListener('click', self.changeLayer.bind(self));\n\t\t});\n\t}\n\n\thandleStyleLoad(e) {\n\t\tif(!Object.keys(this.layers).length) {\n\t\t\tthis.addOverlays();\n\t\t\tthis.addMarkers();\n\t\t} else {\n\n\t\t\tObject.keys(this.layers).forEach((layerID) => {\n\t\t\t\tif(!this.map.getSource(layerID)) {\n\t\t\t\t\tconst layer = this.layers[layerID],\n\t\t\t\t\t\t\t\tsource = this.sources[layerID],\n\t\t\t\t\t\t\t\tinput = document.getElementById(layerID);\n\t\t\t\t\tif(input && input.checked) {\n\t\t\t\t\t\tlayer.layout.visibility = \"visible\";\n\t\t\t\t\t}\n\t\t\t\t\tthis.map.addSource(layerID, source);\n\t\t\t\t\tthis.map.addLayer(layer);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tchangeLayer(e) {\n\t\tconst self = this,\n\t\t\t\t\tinput = e.target,\n\t\t\t\t\tchecked = input.checked,\n\t\t\t\t\tform = input.parentElement,\n\t\t\t\t\tlayerID = input.id,\n\t\t\t\t\tsourceID = layerID + \"\",\n\t\t\t\t\tlayerType = form.dataset.layerType,\n\t\t\t\t\tvalue = input.value;\n\n\t\tif(layerType == \"basemap\") {\n\t\t\tif(checked) {\n\t\t\t\tthis.map.setStyle(value);\n\t\t\t}\n\t\t}\n\t\tif(layerType == \"overlay\") {\n\t\t\tObject.keys(this.overlays).forEach((thisID) => {\n\t\t\t\tconst layer = this.overlays[thisID];\n\t\t\t\tif(layerID == thisID && checked) {\n\t\t\t\t\tthis.map.setLayoutProperty(thisID, 'visibility', 'visible');\n\t\t\t\t} else {\n\t\t\t\t\tdocument.getElementById(thisID).checked = false;\n\t\t\t\t\tthis.map.setLayoutProperty(thisID, 'visibility', 'none');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif(layerType == \"markers\") {\n\t\t\tconst checkedInputs = form.querySelectorAll(\"input:checked\"),\n\t\t\t\t\t\tcheckedValues = Array.from(checkedInputs).map((input) => input.value);\n\t\t\tthis.map.setFilter(\"markers\", [\"in\", \"type\"].concat(checkedValues));\n\t\t}\n\t\t\n\t}\n\n\taddOverlays() {\n\t\tconst self = this,\n\t\t\t\t\tcheckboxes = this.block.querySelectorAll(\"input[name='overlay']\");\n\t\tcheckboxes.forEach(function(checkbox, index) {\n\t\t\tlet layerID = checkbox.id,\n\t\t\t\t\tvalue = checkbox.value,\n\t\t\t\t\tchecked = checkbox.checked,\n\t\t\t\t\toverlaySource = self.map.getSource(layerID + \"\");\n\t\t\tif(!overlaySource && value) {\n\t\t\t\tconst overlaySource = {\n\t\t\t\t\t\"type\": \"raster\",\n\t\t\t\t\t\"url\": checkbox.value\n\t\t\t\t};\n\n\t\t\t\tconst overlayLayer = {\n\t\t\t\t\t\"id\": layerID,\n\t\t\t\t\t\"source\": layerID,\n\t\t\t\t\t\"type\": \"raster\",\n\t\t\t\t\t\"layout\": {\n\t\t\t\t\t\t\"visibility\": checked ? \"visible\" : \"none\"\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tself.map.addSource(layerID, overlaySource);\n\t\t\t\tself.map.addLayer(overlayLayer);\n\t\t\t\t// const overlayLayer = self.map.getLayer(layerID);\n\t\t\t\tself.overlays[layerID] = overlayLayer;\n\t\t\t\tself.layers[layerID] = overlayLayer;\n\t\t\t\tself.sources[layerID] = overlaySource;\n\t\t\t}\n\t\t});\n\t}\n\n\n\taddMarkers() {\n\t\tconst self = this,\n\t\t\t\tmarkersStr = this.block.dataset.markers,\n\t\t\t\tmarkersJSON = markersStr ? JSON.parse(markersStr) : null;\n\t\tthis.block.removeAttribute(\"data-markers\");\n\t\tif(!markersJSON) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.sources[\"markers\"] = {\n\t\t\t\"type\": \"geojson\",\n\t\t\t\"data\": {\n\t\t\t\t\"type\": \"FeatureCollection\",\n\t\t\t\t\"features\": []\n\t\t\t}\n\t\t};\n\n\t\tlet mapBounds = new mapboxgl.LngLatBounds();\n\t\tmarkersJSON.forEach(function(markerObj, index) {\n\t\t\tlet location = markerObj[\"location\"],\n\t\t\t\t\tlat = location[\"o-module-mapping:lat\"],\n\t\t\t\t\tlng = location[\"o-module-mapping:lng\"],\n\t\t\t\t\tcoords = [lng, lat];\n\t\t\tlet marker = {\n\t\t\t\t\"type\": \"Feature\",\n\t\t\t\t\"properties\": {\n\t\t\t\t\t\"description\": markerObj.caption ? markerObj.caption : \"\",\n\t\t\t\t\t\"title\": markerObj.title ? markerObj.title : \"\",\n\t\t\t\t\t\"index\": Number.isInteger(index) ? index + 1 : \"\",\n\t\t\t\t\t\"item\": markerObj.item ? markerObj.item : \"\",\n\t\t\t\t\t\"type\": markerObj.type ? markerObj.type : \"\"\n\t\t\t\t},\n\t\t\t\t\"geometry\": {\n\t\t\t\t\t\"type\": 'Point',\n\t\t\t\t\t\"coordinates\": coords\n\t\t\t\t}\n\t\t\t};\n\t\t\tself.sources[\"markers\"].data.features.push(marker);\n\t\t\tself.markers.push(marker);\n\t\t\tself.getMarkerData(marker, markerObj);\n\t\t\tmapBounds.extend(coords);\n\t\t});\n\n\t\tthis.sources[\"hover-markers\"] = this.sources[\"markers\"];\n\n\t\tthis.map.addSource(\"markers\", this.sources[\"markers\"]);\n\t  this.map.addSource(\"hover-markers\", this.sources[\"hover-markers\"]);\n\n\t\tlet markersLayer = {\n\t\t\t\"id\": \"markers\",\n\t\t\t\"type\": \"circle\",\n\t\t\t\"source\": \"markers\",\n\t\t\t\"paint\": {\n\t\t\t\t\"circle-color\": this.options.color,\n\t\t\t\t\"circle-radius\": 10,\n\t\t\t\t\"circle-stroke-color\": \"rgba(255,255,255,.9)\",\n\t\t\t\t\"circle-stroke-width\": 1.5\n\t\t\t}\n\t\t};\n\n\t\tlet hoverMarkersLayer = {\n\t\t\t\"id\": \"markers-hover\",\n\t\t\t\"type\": \"symbol\",\n\t\t\t\"source\": \"hover-markers\",\n\t\t\t\"layout\": {\n\t\t\t\t\"text-field\": \"{title}\",\n\t\t\t\t\"text-size\": 25,\n\t\t\t\t\"text-font\": [\"Open Sans Semibold\", \"Arial Unicode MS Bold\"],\n\t\t\t\t\"text-offset\": [0, 0.6],\n\t\t\t\t\"text-anchor\": \"top\"\n\t\t\t},\n\t\t\t\"paint\": {\n\t\t\t\t\"text-color\": \"#000000\",\n\t\t\t\t\"text-halo-color\": \"rgba(255,255,255,.9)\",\n\t\t\t\t\"text-halo-width\": 1.5\n\t\t\t},\n\t\t\t\"filter\": [\"==\", \"index\", \"\"]\n\t\t};\n\t\n\t\tthis.map.addLayer(markersLayer);\n\t\tthis.map.addLayer(hoverMarkersLayer);\n\t\tthis.layers[\"markers\"] = markersLayer;\n\t\tthis.layers[\"hover-markers\"] = hoverMarkersLayer;\n\n\t\tthis.map.fitBounds(mapBounds, {\n\t\t\tpadding: {\n\t\t\t\ttop: 100,\n\t\t\t\tbottom: 100,\n\t\t\t\tleft: 100,\n\t\t\t\tright: 100\n\t\t\t},\n\t\t\tanimate: false\n\t\t});\n\t\tthis.bounds = mapBounds;\n\t\tthis.block.classList.add(\"loaded\");\n\t};\n\n\tresetMap() {\n\t\tthis.closePanel();\n\t\tthis.map.fitBounds(this.bounds, {\n\t\t\tpadding: {\n\t\t\t\ttop: 100,\n\t\t\t\tbottom: 100,\n\t\t\t\tleft: 100,\n\t\t\t\tright: 100\n\t\t\t},\n\t\t\tanimate: true\n\t\t});\n\t};\n\n\tflyTo(markerIndex) {\n\t\tconst self = this,\n\t\t\t\tcurrentItem = this.block.querySelector(\".item.current\"),\n\t\t\t\tcurrentIndex = currentItem ? currentItem.dataset.index : null;\n\n\t\tif(currentItem) {\n\t\t\tcurrentItem.classList.remove(\"current\");\n\t\t\tthis.closePanel();\n\t\t}\n\n\t\tif(markerIndex && parseInt(currentIndex) !== parseInt(markerIndex)) {\n\t\t\tlet item = this.block.querySelector(\".item[data-index='\" + markerIndex + \"']\"),\n\t\t\t\t\tnextItem = this.findItem(markerIndex),\n\t\t\t\t\tnextPanel = this.findPanel(markerIndex),\n\t\t\t\t\tpanelPadding = 15,\n\t\t\t\t\tpanelWidth = nextPanel.offsetWidth + panelPadding,\n\t\t\t\t\tblockWidth = this.block.offsetWidth,\n\t\t\t\t\toffsetX = blockWidth / 2 - (blockWidth - panelWidth) / 2,\n\t\t\t\t\tcoordStr = nextItem.dataset.markerCoords;\n\n\t\t\tnextItem.classList.add(\"current\");\n\n\t\t\tif(coordStr && coordStr.length) {\n\t\t\t\tlet coordArr = JSON.parse(coordStr);\n\t\t\t\tthis.map.flyTo({\n\t\t\t\t\tcenter: coordArr,\n\t\t\t\t\tspeed: 5,\n\t\t\t\t\tzoom: 8\n\t\t\t\t});\n\t\t\t\tthis.map.once(\"moveend\", function(data) {\n\t\t\t\t\tlet centerCoords = self.map.getCenter(),\n\t\t\t\t\t\t\tposition = self.map.project(centerCoords);\n\t\t\t\t\tposition.x -= offsetX;\n\n\t\t\t\t\tcenterCoords = self.map.unproject(position);\n\t\t\t\t\tself.map.flyTo({\n\t\t\t\t\t\tcenter: centerCoords\n\t\t\t\t\t});\n\t\t\t\t\tself.openPanel(markerIndex);\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tlet nextItem = this.block.querySelector(\".item.hidden\");\n\t\t\tif(nextItem) {\n\t\t\t\tnextItem.classList.add(\"current\");\n\t\t\t}\n\t\t}\n\t};\n\n\tclickArrow(e) {\n\t\tlet direction = e.target.getAttribute(\"data-direction\"),\n\t\t\t\titems = this.block.querySelectorAll(\".item\"),\n\t\t\t\tcurrentItem = this.block.querySelector(\".item.current\"),\n\t\t\t\tnextItem;\n\n\t\tif(!currentItem) {\n\t\t\tnextItem = items[0];\n\t\t} else if(direction === \"next\") {\n\t\t\tnextItem = currentItem.nextElementSibling;\n\t\t} else if(direction === \"prev\") {\n\t\t\tnextItem = currentItem.previousElementSibling;\n\t\t}\n\t\tif(nextItem) {\n\t\t\tlet nextMarkerId = nextItem.dataset.index;\n\t\t\tthis.flyTo(nextMarkerId);\n\t\t} else {\n\t\t\tthis.resetMap();\n\t\t}\n\t};\n\n\tclickItem(e) {\n\t\tlet item = e.target;\n\t\tif(item) {\n\t\t\tlet markerIndex = item.dataset.index;\n\t\t\tthis.flyTo(markerIndex);\n\t\t}\n\t};\n\n\tgetMarkerData(marker, markerObj) {\n\t\tconst self = this,\n\t\t\t\tapi = markerObj.location['o:item']['@id'];\n\t\t$.ajax({\n\t\t\ttype: 'GET',\n\t\t\tdataType: 'json',\n\t\t\turl: api,\n\t\t\tsuccess: function(data) {\n\t\t\t\tself.populatePopup(marker, data);\n\t\t\t\tself.populatePanel(marker, data);\n\t\t\t},\n\t\t\terror: function(jqXHR, status, error) {\n\t\t\t\tconsole.log(jqXHR, status, error);\n\t\t\t}\n\t\t});\n\t};\n\n\tpopulatePopup(marker, data) {\n\t\tlet popup = document.createElement(\"div\");\n\t\tpopup.classList.add(\"map-popup\");\n\t\tpopup.dataset.index = marker.properties.index;\n\n\t\tlet popupTitle = document.createElement(\"h4\");\n\t\tpopupTitle.innerText = marker.properties.title;\n\n\t\tpopup.appendChild(popupTitle);\n\t\tthis.container.appendChild(popup);\n\n\t\tlet item = this.block.querySelector(\".item[data-index='\" + marker.properties.index + \"']\");\n\t\titem.classList.add(\"ready\");\n\t};\n\n\tpopulatePanel(marker, data) {\n\t\tconst self = this;\n\n\t\tconst panel = document.createElement(\"div\");\n\t\tpanel.classList.add(\"map-panel\");\n\t\tpanel.dataset.index = marker.properties.index;\n\n\t\tconst panelHeader = document.createElement(\"header\");\n\n\t\tconst panelTitle = document.createElement(\"h2\");\n\t\tpanelTitle.innerText = marker.properties.title;\n\n\t\tconst prevArrow = document.createElement(\"div\");\n\t\tprevArrow.classList.add(\"map-arrow\");\n\t\tprevArrow.dataset.direction = \"prev\";\n\t\tprevArrow.addEventListener(\"mousedown\", this.clickArrow.bind(this));\n\t\tconst nextArrow = document.createElement(\"div\");\n\t\tnextArrow.classList.add(\"map-arrow\");\n\t\tnextArrow.dataset.direction = \"next\";\n\t\tnextArrow.addEventListener(\"mousedown\", this.clickArrow.bind(this));\n\n\t\tlet panelInner = document.createElement(\"div\");\n\t\tpanelInner.classList.add(\"panel-inner\");\n\t\tpanelInner.appendChild(panelTitle.cloneNode(true));\n\n\t\tlet panelScroll = document.createElement(\"div\");\n\t\tpanelScroll.classList.add(\"panel-scroll\");\n\n\t\tlet panelProperties = document.createElement(\"div\");\n\t\tpanelProperties.classList.add(\"panel-properties\");\n\n\t\tpanelHeader.appendChild(panelTitle);\n\t\tpanelHeader.appendChild(prevArrow);\n\t\tpanelHeader.appendChild(nextArrow);\n\t\tpanel.appendChild(panelHeader);\n\t\tpanelInner.appendChild(panelProperties)\n\t\tpanelScroll.appendChild(panelInner)\n\t\tpanel.appendChild(panelScroll);\n\n\t\tthis.container.appendChild(panel);\n\n\t\tlet terms = [['alternative', 'Alt Title'], ['date', 'Date'], ['description', 'Description'], ['references', 'Referenced Items'], ['mediator', 'Media']];\n\t\tterms.forEach(function(term, i) {\n\t\t\tlet slug = term[0],\n\t\t\t\t\tlabel = term[1],\n\t\t\t\t\tvals = data['dcterms:' + slug];\n\t\t\tif (vals) {\n\t\t\t\tlet panelProperty = document.createElement(\"div\");\n\t\t\t\tpanelProperty.classList.add(\"panel-property\");\n\t\t\t\tpanelProperty.classList.add(slug);\n\n\t\t\t\tlet panelPropertyLabel = document.createElement(\"div\");\n\t\t\t\tpanelPropertyLabel.innerText = label;\n\t\t\t\tvals.forEach(function(valObj, j) {\n\t\t\t\t\tif (valObj['type'] === 'resource:item') {\n\t\t\t\t\t\tconst title = valObj['display_title'],\n\t\t\t\t\t\t\t\t\turl = valObj['@id'].replace('api', 'home').replace('items', 'item');\n\n\t\t\t\t\t\tlet link = document.createElement(\"a\");\n\t\t\t\t\t\tlink.href = url;\n\t\t\t\t\t\tlink.target = \"_blank\";\n\n\t\t\t\t\t\tif (valObj['property_label'] === 'Mediator') {\n\t\t\t\t\t\t\tsrc = valObj['thumbnail_url'];\n\t\t\t\t\t\t\tlet img = document.createElement(\"img\");\n\t\t\t\t\t\t\timg.src = src;\n\t\t\t\t\t\t\tlink.appendChild(img);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlink.innerText = title;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpanelProperty.appendChild(link);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpanelProperty.innerText += valObj['@value'];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif(panelProperty) {\n\t\t\t\t\tpanelProperties.appendChild(panelProperty);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tpanelInner.appendChild(panelProperties);\n\t};\n\n\thoverMarker(e) {\n\t\tlet marker = e.features[0],\n\t\t\t\tmarkerIndex = marker.properties.index;\n\t\tthis.map.getCanvas().style.cursor = \"pointer\";\n\t\tthis.map.setFilter(\"markers-hover\", [\"==\", \"index\", marker.properties.index]);\n\t\tthis.openPopup(markerIndex);\n\t};\n\n\tunhoverMarker(e) {\n\t\tthis.map.getCanvas().style.cursor = \"\";\n\t\tthis.map.setFilter(\"markers-hover\", [\"==\", \"index\", \"\"]);\n\t\tthis.closePopup();\n\t};\n\n\topenPopup(markerIndex) {\n\t\tlet popup = this.findPopup(markerIndex);\n\t\tif(popup) {\n\t\t\tpopup.classList.add(\"show\");\n\t\t}\n\t};\n\n\tclosePopup() {\n\t\tlet popup = this.container.querySelector(\".map-popup\")\n\t\tif(popup) {\n\t\t\tpopup.classList.remove(\"show\");\n\t\t}\n\t};\n\n\tclickMarker(e) {\n\t\tlet marker = e.features[0],\n\t\t\t\tmarkerIndex = marker.properties.index;\n\t\tthis.flyTo(markerIndex);\n\t};\n\n\topenPanel(markerIndex) {\n\t\tconst self = this,\n\t\t\t\tpanel = this.findPanel(markerIndex);\n\t\tpanel.classList.add(\"show\");\n\t\tsetTimeout(function() {\n\t\t\tself.map.once(\"click\", function(e) {\n\t\t\t\tpanel.classList.remove(\"show\");\n\t\t\t});\n\t\t});\n\t};\n\n\tclosePanel() {\n\t\tlet panel = this.findPanel();\n\t\tif(panel) {\n\t\t\tpanel.classList.remove(\"show\");\n\t\t}\n\t\tlet item = this.findItem();\n\t\tif(item) {\n\t\t\titem.classList.remove(\"current\");\n\t\t}\n\t};\n\n\tfindPanel(markerIndex) {\n\t\tlet panel = this.container.querySelector(\".map-panel[data-index='\" + markerIndex + \"']\");\n\t\tif(panel) {\n\t\t\treturn panel;\n\t\t}\n\t\tpanel = this.container.querySelector(\".map-panel.show\");\n\t\tif(panel) {\n\t\t\treturn panel;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tfindPopup(markerIndex) {\n\t\tlet popup = this.container.querySelector(\".map-popup[data-index='\" + markerIndex + \"']\");\n\t\tif(popup && popup.length) {\n\t\t\treturn popup;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tfindItem(markerIndex) {\n\t\tlet item = this.block.querySelector(\".item[data-index='\" + markerIndex + \"']\");\n\t\tif(item) {\n\t\t\treturn item;\n\t\t}\n\t\titem = this.block.querySelector(\".item.current\");\n\t\tif(item) {\n\t\t\treturn item;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tfindMarker(mapId, markerIndex) {\n\n\t};\n\n};\n\nwindow.onload = function() {\n\tlet map = new ExploratoryMap({});\n};","// extracted by mini-css-extract-plugin"],"sourceRoot":""}